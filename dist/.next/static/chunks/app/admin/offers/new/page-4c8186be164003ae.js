(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[548],{13962:function(e,a,i){Promise.resolve().then(i.bind(i,92119))},92119:function(e,a,i){"use strict";i.r(a),i.d(a,{default:function(){return c}});var r=i(57437),l=i(2265),n=i(9997);function s(e){let{onDone:a}=e,[i,n]=(0,l.useState)(!1),[s,t]=(0,l.useState)(""),c=async e=>{var i;let r=null===(i=e.target.files)||void 0===i?void 0:i[0];if(!r)return;n(!0);let l=new FormData;l.set("file",r);let s=await fetch("/api/admin/upload-image",{method:"POST",body:l}),c=await s.json();n(!1),c.ok?(t(c.url),a(c.url)):alert(c.error||"Upload failed")};return(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:c,disabled:i}),s&&(0,r.jsx)("img",{src:s,alt:"preview",className:"w-full max-w-xs rounded-xl border"})]})}var t=i(99376);function c(){let e=(0,t.useRouter)(),a=(0,n.z)(),[i,c]=(0,l.useState)([]),[d,o]=(0,l.useState)({title:"",description:"",city:"",cuisine:"",original_price:0,discounted_price:0,pickup:!0,delivery:!0,restaurant_id:void 0,provider_id:"",image_url:"",deep_link:"",status:"active"});function u(e,a){o(i=>({...i,[e]:a}))}async function p(){let{error:i}=await a.from("offers").insert([d]);i?console.error("Error saving offer:",i):e.push("/admin/offers")}return(0,l.useEffect)(()=>{(async()=>{let{data:e}=await a.from("providers").select("id,name,slug").order("name");c(null!=e?e:[]),e&&e[0]&&o(a=>({...a,provider_id:e[0].id}))})()},[a]),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"New Offer"}),(0,r.jsxs)("div",{className:"mt-4 grid gap-3 max-w-xl",children:[(0,r.jsx)("select",{className:"border rounded-xl px-3 py-2",value:d.provider_id,onChange:e=>u("provider_id",e.target.value),children:i.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,r.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Title",value:d.title,onChange:e=>u("title",e.target.value)}),(0,r.jsx)("textarea",{className:"border rounded-xl px-3 py-2",placeholder:"Description",value:d.description,onChange:e=>u("description",e.target.value)}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("label",{className:"grid gap-1",children:[(0,r.jsx)("span",{children:"Original Price (€)"}),(0,r.jsx)("input",{type:"number",step:"0.01",className:"border rounded-xl px-3 py-2",value:d.original_price,onChange:e=>u("original_price",parseFloat(e.target.value)||0)})]}),(0,r.jsxs)("label",{className:"grid gap-1",children:[(0,r.jsx)("span",{children:"Discounted Price (€)"}),(0,r.jsx)("input",{type:"number",step:"0.01",className:"border rounded-xl px-3 py-2",value:d.discounted_price,onChange:e=>u("discounted_price",parseFloat(e.target.value)||0)})]})]}),(0,r.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"City",value:d.city,onChange:e=>u("city",e.target.value)}),(0,r.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Cuisine",value:d.cuisine,onChange:e=>u("cuisine",e.target.value)}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:d.pickup,onChange:e=>u("pickup",e.target.checked)}),"Pickup"]}),(0,r.jsxs)("label",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:d.delivery,onChange:e=>u("delivery",e.target.checked)}),"Delivery"]})]}),(0,r.jsxs)("label",{className:"grid gap-1",children:[(0,r.jsx)("span",{children:"Deep Link"}),(0,r.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Deep link URL",value:d.deep_link,onChange:e=>u("deep_link",e.target.value)})]}),(0,r.jsxs)("label",{className:"grid gap-1",children:[(0,r.jsx)("span",{children:"Image URL"}),(0,r.jsx)("input",{id:"imgUrl",className:"border rounded-xl px-3 py-2",placeholder:"Image URL",value:d.image_url,onChange:e=>u("image_url",e.target.value)})]}),(0,r.jsx)(s,{onDone:e=>u("image_url",e)}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"btn btn-primary",onClick:p,children:"Save"}),(0,r.jsx)("button",{className:"btn",onClick:()=>e.push("/admin"),children:"Cancel"})]})]})]})}},9997:function(e,a,i){"use strict";i.d(a,{z:function(){return l}});var r=i(21388);function l(){return(0,r.createBrowserClient)("https://wpkcawjvhnaykqjgcgye.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indwa2Nhd2p2aG5heWtxamdjZ3llIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxMTYwNzMsImV4cCI6MjA3MzY5MjA3M30.qaXBidq7R3hTJHG9J0ObYoGIi4UWKuQqSe0r3tGtTlA")}},99376:function(e,a,i){"use strict";i.r(a);var r=i(35475),l={};for(var n in r)"default"!==n&&(l[n]=(function(e){return r[e]}).bind(0,n));i.d(a,l)}},function(e){e.O(0,[388,971,117,744],function(){return e(e.s=13962)}),_N_E=e.O()}]);